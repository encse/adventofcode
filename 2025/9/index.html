<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <link href='https://fonts.googleapis.com/css?family=Noto Sans' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/a11y-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/csharp.min.js"></script>
    <title>Advent of Code 2025/9 'Movie Theater'' in C# by encse</title>

    <head>
        <meta property="og:title" content="Advent of Code 2025/9 'Movie Theater' in C# by encse">
        <meta property="og:description" content="C# solution to the 'Movie Theater' Advent of Code problem.">
        <meta property="og:image" content="https://aoc.csokavar.hu/2025/9//illustration.jpg">
        <meta property="og:url" content="https://aoc.csokavar.hu/2025/9/">
        <meta property="og:type" content="website">
      </head>


    <style>
        html {
            --theme-background-color: #2b2b2b;
            --theme-background-color2: #0d1117;
        }

        * {
            box-sizing: border-box;
            /* text is too big without these in my iphone */
            -moz-text-size-adjust: none;
            -webkit-text-size-adjust: none;
            text-size-adjust: none;
        }

        @media (min-width:2000px) {
            html {
                font-size: 1.9em;
            }
        }

        a {
            color: inherit;
        }

        body {
            background: var(--theme-background-color);
            margin: 0;
            padding: 0;
            font-family: 'Noto Sans', 'Arial', sans-serif;
            color: white;
        }

        .main {
            width: 100ch;
            display: flex;
            flex-direction: column;
            padding: 1em;
            margin: 4em auto;
        }


        .header-container {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap-reverse;
            justify-content: center;
            gap: 1em;
            overflow: hidden;
            position: relative;
        }

        .header-image {
            display: flex;
            min-width: 400px;
            position: relative;
            position: absolute;
            z-index: -1;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
        }

        .header-image img {
            object-fit: cover;
        }

        .header-title {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            text-align: center;
            text-shadow: 0 0 1px rgba(0, 0, 0, 0.7); 
            padding: 10em;
            background-image: radial-gradient(rgba(194, 194, 194, 0.03), rgba(195, 195, 195, 0.05));
        }

        .header-title h2 {
            font-size: 400%;
            margin: 0;
        }

        .header-title p {
            font-size: 150%;
        }

        #dropdown-label {
            text-align: center;
            margin: 1em;
        }

        .dropdown-toggle {
            display: none; /* Hide the checkbox */
        }

        .dropdown-content {
            display: none;
            position: absolute;
            z-index: 1;
            list-style: none;
            background-color: #0d1117;
        }

        .dropdown-content {
            flex-direction: column;

        }

        .dropdown-content a {
            margin: 0.5em 1em;
        }

        #dropdown-toggle:checked  ~ .dropdown-content {
            display: flex; 
        }

        #top-nav,
        #bottom {
            background: var(--theme-background-color2);
            padding: 1em;
        }

        #year-picker select {
            border: none;
            background: inherit;
            font-size: inherit;
            color: inherit;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        #top-nav a,
        .header-container a {
            text-decoration: none;
        }

        #top-nav .current {
            color: var(--theme-background-color2);
            background: white;
        }

        #bottom {
            background: var(--theme-background-color2);
            display: flex;
            flex-wrap: wrap;
            gap: 2em;
            justify-content: center;
        }

        #top-nav {
            display: flex;
        }

        #top-nav select {
            margin-left: 1em;
            margin-right: 1em;
        }

        #day-picker {
            display: flex;
            flex-wrap: wrap;
        }

        #day-picker a {
            margin: 1em;
        }

        #code-container {
            overflow: auto;
            scroll-behavior: smooth;
        }

        .hljs {
            background: var(--theme-background-color2);
        }

        .hljs-ln-numbers {
            padding-right: 1em !important;
            text-align: right;
        }

        .content {
            line-height: 1.5;
            margin-top: 2em;
            /* hyphens: auto; */
        }

        .content img {
            width: 70%;
        }


        @media (max-width: 1024px) {
            .main {
                width: inherit;
            }

            .content {
                width: 100%;
            }

            .header-title h2 {
                font-size: 300%;
            }
        }

        @media (orientation: landscape) {
            main {
                width: 90%;
            }
        }
    </style>
</head>

<body lang="en-US">
    <div id="top-nav">
        <div id="year-picker"><nav class="dropdown">
            <input type="checkbox" id="dropdown-toggle" class="dropdown-toggle">
            <span class="current"><label id="dropdown-label" for="dropdown-toggle">2025</label></span>
            <div class="dropdown-content"><a href="/2015/25/">2015</a><a href="/2016/25/">2016</a><a href="/2017/25/">2017</a><a href="/2018/25/">2018</a><a href="/2019/25/">2019</a><a href="/2020/25/">2020</a><a href="/2021/25/">2021</a><a href="/2022/25/">2022</a><a href="/2023/25/">2023</a><a href="/2024/25/">2024</a><a href="/2025/9/">2025</a></div>
        </nav>
     </div>
        <div id="day-picker"><span><a href="/2025/1">01</a></span><span><a href="/2025/2">02</a></span><span><a href="/2025/3">03</a></span><span><a href="/2025/4">04</a></span><span><a href="/2025/5">05</a></span><span><a href="/2025/6">06</a></span><span><a href="/2025/7">07</a></span><span><a href="/2025/8">08</a></span><span class="current"><a href="/2025/9">09</a></span></div>
    </div>
    <div class="main">
        <div class="header-container">
            <div class="header-image">
                <img id="cover" width="100%" src="illustration.jpg" />
            </div>

            <div class="header-title">
                <p class="text">Advent of Code</p>
                <h2 id="problem-id">2025/9</h2>
                <h2 id="problem-name">Movie Theater</h2>
                <p class="text">in C#</p>
                <p class="text"></p>
                <p class="text"><em>by <a style="text-decoration: underline"
                            href="https://github.com/sponsors/encse">encse</a></em></p>
            </div>

        </div>

        <div class="content">
            <div id="notes"><em>
You slide down the [firepole](https://en.wikipedia.org/wiki/Fireman%27s_pole) in the corner of the playground and land in the North Pole base movie theater!

<p>The movie theater has a big tile floor with an interesting pattern. Elves here are redecorating the theater by switching out some of the square tiles in the big grid they form. Some of the tiles are <em>red</em>; the Elves would like to find the largest rectangle that uses red tiles for two of its opposite corners. They even have a list of where the red tiles are located in the grid (your puzzle input).</p>
<p>Visit the website for the full story and <a href="https://adventofcode.com/2025/day/9">full puzzle</a> description.
</em></p>
<p>This one really caused me a headache. I made a bug in the area function, at the beginning, which was not triggered
in part one. Then came the strugling for hours which overloaded my mind. My head was full of intersection functions and 
ray casting and eye balling for errors, but it just didn&#39;t work.</p>
<p>I made a little python script that draws the input, which is a circle with a slot in the middle. Looked really special, 
I started to add heuristics to my solution, but of course this didn&#39;t help due to the bogus area function.</p>
<p>After the 200th read, I finally spotted my mistake and got the second star, but I got tired of the whole thing and couldn&#39;t 
really put this into a nice form.  </p>
<p>At the end, I started to read the solution thread and spotted that a simple <code>AabbCollision</code> function is enough. And 
somehow it clicked. Without the hint, I would have been on the wrong track for a much longer time for sure.</p>
<p>But at least the final result looks good in my opinion.</p>
</div>
            <div id="code-container"><pre class="hljs language-csharp"><code>namespace AdventOfCode.Y2025.Day09;

using System;
using System.Collections.Generic;
using System.Linq;
using System.Numerics;

record Rectangle(long top, long left, long bottom, long right);

[ProblemName(&quot;Movie Theater&quot;)]
class Solution : Solver {

    public object PartOne(string input) {
        var points = Parse(input);
        return (
             from r in RectanglesOrderedByArea(points)
             select Area(r)
         ).First();
    }

    public object PartTwo(string input) {
        var points = Parse(input);
        var segments = Boundary(points).ToArray();
        return (
             from r in RectanglesOrderedByArea(points)
             where segments.All(s =&gt; !AabbCollision(r, s))
             select Area(r)
         ).First();
    }

    IEnumerable&lt;Rectangle&gt; RectanglesOrderedByArea(Complex[] points) =&gt;
        from p1 in points
        from p2 in points 
        let r = RectangleFromPoints(p1, p2)
        orderby Area(r) descending
        select r;

    IEnumerable&lt;Rectangle&gt; Boundary(Complex[] corners) =&gt;
        from pair in corners.Zip(corners.Prepend(corners.Last()))
        select RectangleFromPoints(pair.First, pair.Second);

    Rectangle RectangleFromPoints(Complex p1, Complex p2) {
        var top = Math.Min(p1.Imaginary, p2.Imaginary);
        var bottom = Math.Max(p1.Imaginary, p2.Imaginary);
        var left = Math.Min(p1.Real, p2.Real);
        var right = Math.Max(p1.Real, p2.Real);
        return new Rectangle((long)top, (long)left, (long)bottom, (long)right);
    }

    Complex[] Parse(string input) =&gt; (
        from line in input.Split(&quot;\n&quot;)
        let parts = line.Split(&quot;,&quot;).Select(int.Parse).ToArray()
        select parts[0] + Complex.ImaginaryOne * parts[1]
    ).ToArray();

    long Area(Rectangle r) =&gt; (r.bottom - r.top + 1) * (r.right - r.left + 1);

    // see https://kishimotostudios.com/articles/aabb_collision/
    bool AabbCollision(Rectangle a, Rectangle b) {
        var aIsToTheLeft = a.right &lt;= b.left;
        var aIsToTheRight = a.left &gt;= b.right;
        var aIsAbove = a.bottom &lt;= b.top;
        var aIsBelow = a.top &gt;= b.bottom;
        return !(aIsToTheRight || aIsToTheLeft || aIsAbove || aIsBelow);
    }
}</code></pre></div>
            <div id="code-location"> <p>Please ☆ my <a href="https://github.com/encse/adventofcode/">repo</a> if you like it!</p></div>
        </div>

    </div>
    <div id="bottom">
        <span>© <span id="currentYear">2025</span> | 
        <a href="https://adventofcode.com">Advent of Code</a> is a registered trademark in the US | 
        Images provided by <a href="https://www.bing.com/images/create">Bing</a> and <a href="https://gemini.google.com/app">Nano Banana</a></span>
    </div>
 
    <script>
        // This will automatically apply highlight.js to all <pre><code> blocks
        document.addEventListener('DOMContentLoaded', function () {

        let yearPicker = document.querySelector('#year-picker select')
        if (yearPicker) {
            yearPicker.addEventListener('change', function () {
                window.location = this.value;
            });
        }

          // Automatically highlight all <code> blocks inside <pre>
          hljs.highlightAll();
        });
    </script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P8Y1BWSSF3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-P8Y1BWSSF3');
    </script>
</body>

</html>